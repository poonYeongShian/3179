{
   "$schema":"https://vega.github.io/schema/vega-lite/v5.json",
   "background":"#fff7fb",
   "width": 620,
   "height":350,
   "title":"Number of EV car sold over the years",
   "data":{
      "url":"https://raw.githubusercontent.com/poonYeongShian/FIT3179/main/week10_homework/data/IEA-EV-dataEV-salesHistoricalCars.csv"
   },
   "params":[
      {
         "name":"current_year",
         "value":2015,
         "bind":{
            "input":"range",
            "min":2015,
            "max":2022,
            "step":1,
            "name":"Year: "
         }
      }
   ],
   "transform":[
      {
         "filter":{
            "timeUnit":"year",
            "field":"year",
            "equal":"current_year"
         }
      },
      {"calculate": "datum.value / 1000", "as": "value_in_k"}

   ],
   "encoding":{
      "x":{
         "field":"value_in_k",
         "aggregate":"sum",
         "type":"quantitative",
         "title":"EV car sales (thousand unit)"
      },
      "y":{
         "field":"region",
         "title":"Country",
         "sort":{
            "op":"sum",
            "field":"value_in_k",
            "order":"descending"
         }
      }
   },
   "layer":[
      {
         "mark":"bar",
         "encoding":{
            "color":{
               "field":"region",
               "type":"nominal",
               "scale":{
                  "range" : [
                     "#a6bddb",
                     "#ece7f2",
                     "#ece7f2",
                     "#ece7f2",
                     "#ece7f2",
                     "#ece7f2",
                     "#ece7f2"
                  ]
               },
               "legend":null
            },
            "tooltip":[
               {
                  "field":"region",
                  "type":"nominal",
                  "title":"Country"
               },
               {
                  "field": "value",
                  "aggregate":"sum",
                  "type":"quantitative",
                  "title":"Number of EV car sold"
               }
            ]
         }
      },
      {
         "mark":{
            "type":"text",
            "align":"left",
            "xOffset":-10
         },
         "encoding":{
            "text":{
               "field": "value_in_k",
               "aggregate":"sum",
               "type":"quantitative",
               "format" : ".1s" 
            },
            "color":{
               "value":"black"
            }
         }
      }
   ]
}